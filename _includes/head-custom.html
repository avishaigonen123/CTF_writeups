<link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">

<!-- remove the cache headers -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<!-- Simple "Back" link -->
<style>
  .back-link {
    text-decoration: none;
    color: #007acc;
    font-size: 1.4em;
    font-weight: bold;
  }

  .back-link:hover {
    text-decoration: underline;
  }

  .back-container {
    width: 100%;
    display: flex;
    justify-content: flex-start;
    padding-left: 16.90%; 
    margin: 30px 0;
  }
</style>

<div class="back-container">
  <a id="back-link" class="back-link" href="#">‚Üê Back</a>
</div>

<script>
  // Go one folder up from current URL
  const parts = window.location.pathname.split('/').filter(Boolean);
  
  // Remove the last part (current page or last folder)
  parts.pop(); 
  
  // If we're already at the root level, make sure the parent is '/'
  const parent = parts.length > 0 ? '/' + parts.join('/') + '/' : '/';
  
  // Update the back-link href attribute
  document.getElementById('back-link').href = parent;
</script>

<!-- Search functionality -->

<!-- üîç Global Search Bar -->
<div id="search-container">
  <input type="text" id="search-input" placeholder="Search  CTF Writeups..." aria-label="Search CTF Writeups..." />
  <ul id="results-container"></ul>
</div>

<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
const searchInput = document.getElementById('search-input');
const resultsContainer = document.getElementById('results-container');

let allResults = []; // Store all results
let displayedCount = 10; // Initial number of results to show
let searchQuery = '';

function renderResults(count) {
  resultsContainer.innerHTML = '';
  const toDisplay = allResults.slice(0, count);
  toDisplay.forEach(post => {
    const li = document.createElement('li');
    li.innerHTML = `<a href="${post.url}" style="color:#0f0;">${post.title}</a>`;
    resultsContainer.appendChild(li);
  });

  // Show "Search More" button if there are more results
  if (allResults.length > count) {
    let moreBtn = document.createElement('button');
    moreBtn.textContent = 'Search More';
    moreBtn.style = 'margin-top:10px; padding:6px 12px; font-size:1em; background:#0f0; color:#000; border:none; border-radius:4px; cursor:pointer;';
    moreBtn.addEventListener('click', () => {
      displayedCount += 10; // Show 10 more results each click
      renderResults(displayedCount);
    });
    resultsContainer.appendChild(moreBtn);
  }
}

// Initialize SimpleJekyllSearch
SimpleJekyllSearch({
  searchInput: searchInput,
  resultsContainer: resultsContainer,
  json: '{{ site.baseurl }}/search.json',
  searchResultTemplate: '', // We'll render manually
  fuzzy: false,
  templateMiddleware: (prop, value, template) => value,
  filter: function (post, query) {
    const terms = query.toLowerCase().trim().split(/\s+/);
    const haystack = `${post.title} ${post.content}`.toLowerCase();
    return terms.every(term => haystack.includes(term));
  },
  searchCallback: function(results) {
    searchQuery = searchInput.value.trim();
    allResults = results;
    displayedCount = 10; // Reset count on new search
    renderResults(displayedCount);
  }
});

// Clear results when input is empty
searchInput.addEventListener('input', () => {
  if (!searchInput.value.trim()) {
    resultsContainer.innerHTML = '';
    allResults = [];
  }
});
</script>
  
<style>
  #search-container {
    max-width: 1000px;
    margin: 20px auto 0;
    padding: 0 15px;
  }

  #search-input {
    width: 100%;
    padding: 8px 12px;
    font-size: 1.5em;
    border: 1px solid #00ff00;
    border-radius: 4px;
    background-color: #111;
    color: #0f0;
  }

  #results-container {
    margin-top: 10px;
    list-style: none;
    padding: 0;
    color: #0f0;
  }

  #results-container li {
    background: #111;
    border: 1px solid #0f0;
    padding: 10px;
    margin: 6px 0;
    border-radius: 4px;
  }
</style>
