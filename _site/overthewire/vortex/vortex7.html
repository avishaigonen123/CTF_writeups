<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>vortex7 | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="vortex7" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/overthewire/vortex/vortex7.html" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/overthewire/vortex/vortex7.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="vortex7" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"vortex7","url":"http://localhost:4000/CTF_writeups/overthewire/vortex/vortex7.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=c7717680ee836fb275ca7ab0727bb88d0c432f55">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/CTF_writeups/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/CTF_writeups/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">
  </head>
  <body>
      <div id="header">
        <nav>
          <ul>
            <li class="fork"><a href="https://github.com/avishaigonen123/CTF_writeups">View On GitHub</a></li>
            
          </ul>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Avishai's CTF Writeups</h1>
          <p>...</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/avishaigonen123">avishaigonen123</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
        </div>

        <h1 id="vortex-level7-solution">vortex level7 Solution</h1>

<p>in this level we need to exploit buffer overflow. also, the CRC32 of the buffer needs to be <code class="language-plaintext highlighter-rouge">0xe1ca95ee</code></p>

<h4 id="calculate-the-crc">calculate the CRC</h4>
<ul>
  <li>
    <p>brute force
  we modify the CRC32 of the buffer by adding 4 bytes at the end, which gives us the ability to change the CRC32 to every possible value.</p>

    <p>i decided to go on brute force, however, calculating 2^32 can be very expensive, so i added some optimization by brute forcing only 3 bytes, and the last byte can be derived directly.
  now it is possible to calculate the CRC, it takes about 10 seconds.</p>
  </li>
  <li>
    <p>retrieve the CRC tables
  there are saved CRC tables which are stored in the memory, you need to achieve them and put them in the code.
  this is the command i used in radare2 <code class="language-plaintext highlighter-rouge">pxw 256*4 @obj.crc32_table</code>.
<img src="/CTF_writeups/overthewire/vortex/images/level7_1.png" alt="image" /></p>
  </li>
</ul>

<h4 id="build-the-payload">build the payload</h4>
<ul>
  <li>as we can see, we can’t just override the return address, we need to put in the esp something the will point to somewhere, this will be stored in ecx.
than, it will go 4 back and inside this memory, it’ll find the shellcode address.</li>
</ul>

<p><img src="/CTF_writeups/overthewire/vortex/images/level7_2.png" alt="image" /></p>

<p>we’ll put in ecx the address forward, and then in ebx and ebp the shellcode address.
<img src="/CTF_writeups/overthewire/vortex/images/level7_3.png" alt="image" /></p>

<p>also, you need to find the shellcode address, i put the shellcode in the buffer after @ebp+0x4, just debug and you’ll find.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">scripts</span><span class="o">/</span><span class="n">level7</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div>
<p>, all you need to change is <code class="language-plaintext highlighter-rouge">shellcode_address</code> and <code class="language-plaintext highlighter-rouge">ecx_address</code>.</p>

<p><img src="/CTF_writeups/overthewire/vortex/images/level7_4.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">niEUGtu7f</code></em></strong></p>


      </section>

    </div>
  </body>
</html>
