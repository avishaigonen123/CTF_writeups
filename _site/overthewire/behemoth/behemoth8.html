<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>behemoth8 | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="behemoth8" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/overthewire/behemoth/behemoth8.html" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/overthewire/behemoth/behemoth8.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="behemoth8" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"behemoth8","url":"http://localhost:4000/CTF_writeups/overthewire/behemoth/behemoth8.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=c7717680ee836fb275ca7ab0727bb88d0c432f55">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/CTF_writeups/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/CTF_writeups/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">
  </head>
  <body>
      <div id="header">
        <nav>
          <ul>
            <li class="fork"><a href="https://github.com/avishaigonen123/CTF_writeups">View On GitHub</a></li>
            
          </ul>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Avishai's CTF Writeups</h1>
          <p>...</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/avishaigonen123">avishaigonen123</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
        </div>

        <h1 id="behemoth-level8-solution">behemoth level8 Solution</h1>

<p>we can see it doesn’t have ASLR and stack protection.
<img src="/CTF_writeups/overthewire/behemoth/images/level8_1.png" alt="alt text" /></p>

<p>we’ve found using the begin of the script here [level8.py]</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">scripts</span><span class="o">/</span><span class="n">level8</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div>
<p>that after 528 bytes we reach the ret-address. however, when trying to enter non alpha characters, it detects us and closing.</p>

<p>if we’ll look closely, we can see that it checks only the 512 first characters, then, it will go to the strcpy without checking. YAY :)
<img src="/CTF_writeups/overthewire/behemoth/images/level8_2.png" alt="alt text" /></p>

<p>now all left is to find the address of the buffer, play with the debugger to find it. notice it changes based on the length of the input you give it.</p>

<p>here can be found our injection: [level8.py]</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">scripts</span><span class="o">/</span><span class="n">level8</span><span class="p">.</span><span class="n">py</span>
</code></pre></div></div>

<p><img src="/CTF_writeups/overthewire/behemoth/images/level8_3.png" alt="alt text" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">8yWcelJd0D</code></em></strong></p>


      </section>

    </div>
  </body>
</html>
