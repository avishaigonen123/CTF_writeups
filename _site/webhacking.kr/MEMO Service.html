<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Webhacking MEMO Service Solution | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Webhacking MEMO Service Solution" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/webhacking.kr/MEMO%20Service.html" />
<meta property="og:url" content="http://localhost:4000/webhacking.kr/MEMO%20Service.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Webhacking MEMO Service Solution" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"Webhacking MEMO Service Solution","url":"http://localhost:4000/webhacking.kr/MEMO%20Service.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=885199f883f5b847967c84d0262eab1578eb3466">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">
  </head>
  <body>
      <div id="header">
        <nav>
          <ul>
            <li class="fork"><a href="https://github.com/avishaigonen123/CTF_writeups">View On GitHub</a></li>
            
          </ul>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Avishai's CTF Writeups</h1>
          <p>...</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/avishaigonen123">avishaigonen123</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
        </div>

        <h1 id="webhacking-memo-service-solution">Webhacking MEMO Service Solution</h1>

<table>
  <tbody>
    <tr>
      <td>That was tough :</td>
    </tr>
  </tbody>
</table>

<h3 id="xss-injection">XSS Injection</h3>
<p>First, we need to be able to XSS injection the website.
There is bug in the <code class="language-plaintext highlighter-rouge">snprintf.js</code> file, that you can insert <code class="language-plaintext highlighter-rouge">%3c</code>, and then it’ll take the next memo[i], and will execute:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">arg</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</code></pre></div></div>

<p>By this way, we can give this cookie for example:
<code class="language-plaintext highlighter-rouge">["%3c&gt;&lt;img src=x onerror=alert('XSS-injectoin****(~-_-~)****')&gt;","39"]</code> 
base64 encode:
  <em><code class="language-plaintext highlighter-rouge">WyIlM2M+PGltZyBzcmM9eCBvbmVycm9yPWFsZXJ0KCdYU1MtaW5qZWN0b2luKioqKih+LV8tfikqKioqJyk+IiwiMzkiXQ==</code></em></p>

<p><img src="/webhacking.kr/images/MEMO_XSS_injection.png" alt="XSS injection" /></p>

<h4 id="building-the-cookie">Building the cookie</h4>

<p>You can use this script <a href="/webhacking.kr/scripts/MEMO_Service_cookie_build.py">cookie_build.py</a>, for building your cookie, Change the <code class="language-plaintext highlighter-rouge">URL</code>, for your own webhook.</p>

<h3 id="path-traversal">Path Traversal</h3>

<p>Ngnix is vulnerable to path traversal with this encoded slash <code class="language-plaintext highlighter-rouge">%2f</code>, we can go here: <code class="language-plaintext highlighter-rouge">/static/favicon.ico%2f..%2f..%2f</code>, and by this way access the home page.</p>

<h3 id="header-injection-using-clrf">Header Injection Using CLRF</h3>

<p>We can inject the <code class="language-plaintext highlighter-rouge">favicon.ico</code> using CLRF, and by this way modify the request.
<img src="/webhacking.kr/images/MEMO_Header_injection.png" alt="header Injection" /></p>

<h2 id="attack">ATTACK</h2>

<p>we send the admin to the vulnerable page using the <code class="language-plaintext highlighter-rouge">header Injection</code>, and the <code class="language-plaintext highlighter-rouge">path traversal</code>. 
Then, we send in the headers <code class="language-plaintext highlighter-rouge">Set-Cookie</code>, and send the cookie that cause the <code class="language-plaintext highlighter-rouge">XSS Injection</code>.</p>

<p>At the end, this is what we’ll supply to the report page
<code class="language-plaintext highlighter-rouge">favicon.ico%2f..%252f..%2f%0d%0aSet-Cookie:memo=ourMaliciousCookie</code></p>

<p><img src="/webhacking.kr/images/MEMO_Service_FLAG.png" alt="MEMO_final" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">FLAG{giant_double_burger}</code></em></strong></p>



      </section>

    </div>
  </body>
</html>
