<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=6aacf4c090fc5e966ec687925a0bf39a46c3a14c">
    <link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>old-33 | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="old-33" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/webhacking.kr/old-33.html" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/webhacking.kr/old-33.html" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="old-33" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"old-33","url":"http://localhost:4000/CTF_writeups/webhacking.kr/old-33.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/CTF_writeups/">
          <h1>Avishai's CTF Writeups</h1>
        </a>
        <h2>...</h2>

        <section id="downloads">
          
          <a href="https://github.com/avishaigonen123/CTF_writeups" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1 id="webhacking-old-33-solution">Webhacking old-33 Solution</h1>

<p>this challange will be long, each time you will need to do something different until you finish it.</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">https://webhacking.kr/challenge/bonus-6/?get=hehe</code></li>
  <li>…</li>
</ol>

<p>there are bunch of levels, i’ve got no time to explain all. you can see the solution in the source code:
[old-33]</p>
<pre><code class="language-scripts/old-33.py">import requests

# URL = "https://webhacking.kr/challenge/bonus-6/"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# headers = {'Cookie': 'PHPSESSID='+SESSION_ID}
# data = { "get": "hehe" }
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}
# response = requests.post(URL, headers=headers, data=data)
# print(response.text)

# URL = "https://webhacking.kr/challenge/bonus-6/33.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# headers = {'Cookie': 'PHPSESSID='+SESSION_ID}
# data = { "post": "hehe", "post2": "hehe2" }
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}
# response = requests.post(URL, headers=headers, data=data)
# print(response.text)

# URL = "https://webhacking.kr/challenge/bonus-6/33.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# headers = {'Cookie': 'PHPSESSID='+SESSION_ID}
# data = { "post": "hehe", "post2": "hehe2" }
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}
# response = requests.get(URL+"?myip=212.8.250.238", headers=headers)
# print(response.text)

# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/l4.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# headers = {'Cookie': 'PHPSESSID='+SESSION_ID}
# data = { "post": "hehe", "post2": "hehe2" }
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}
# while(True):
#     for i in range(3,10):
#         password = hashlib.md5(str(int(time.time()) + i).encode()).hexdigest()
#         response = requests.get(URL + "?password=" + password, headers=headers)
#         print(f"send message {i}: " + response.text)
#         if "5.php" in response.text:
#             print("\n\n\nfound secret\n\n\n")
#             print(response.text)

# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/md555.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# cookies = {'PHPSESSID':SESSION_ID, 'imcookie':"True"}

# data = { "impost": "True" }
# params = {"imget":True}
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}

# response = requests.post(URL,params=params,data=data, cookies=cookies)
# print(response.text)

# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/gpcc.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# cookies = {'PHPSESSID':SESSION_ID, 'test':hashlib.md5("212.8.250.236".encode()).hexdigest()}

# data = { "kk": hashlib.md5("python-requests/2.31.0".encode()).hexdigest() }
# # params = {"imget":True}
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}

# response = requests.post(URL,data=data, cookies=cookies)
# print(response.text)

    
# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/wtff.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# cookies = {'PHPSESSID':SESSION_ID, 'test':hashlib.md5("212.8.250.236".encode()).hexdigest()}

# data = { "kk": hashlib.md5("python-requests/2.31.0".encode()).hexdigest() }
# params = {"2128250236":"2128250236"}
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}

# response = requests.post(URL,params=params,data=data, cookies=cookies)
# print(response.text)

    
    
# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/ipt.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# cookies = {'PHPSESSID':SESSION_ID, 'test':hashlib.md5("212.8.250.236".encode()).hexdigest()}

# data = { "kk": hashlib.md5("python-requests/2.31.0".encode()).hexdigest() }
# params = {"addr":"127.0.0.1"}
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}

# response = requests.post(URL,params=params,data=data, cookies=cookies)
# print(response.text)

    
    
# import hashlib
# import time
# import random

# URL = "https://webhacking.kr/challenge/bonus-6/nextt.php"
# SESSION_ID = "6f5n50cakmlha0n6pbkc52c3rj"
# cookies = {'PHPSESSID':SESSION_ID, 'test':hashlib.md5("212.8.250.236".encode()).hexdigest()}

# data = { "kk": hashlib.md5("python-requests/2.31.0".encode()).hexdigest() }
# answer=""
# for i in range(97,123,2):
#     answer +=chr(i)
# print(answer)
# params = {"ans":answer}
# # files = {'file':('bla.php','&lt;?php echo system($_GET[\'cmd\']) ?&gt;')}

# response = requests.post(URL,params=params,data=data, cookies=cookies)
# print(response.text)

    
    
import hashlib
import time
import random

URL = "https://webhacking.kr/challenge/bonus-6/forfor.php"
SESSION_ID = "123"
cookies = {'PHPSESSID':SESSION_ID, 'test':hashlib.md5("212.8.250.236".encode()).hexdigest()}

ip = "212.8.250.236"
# for i in range(len(ip)+1):
#     if i&lt;=9:
#         ip = ip.replace(str(i), str(ord(str(i))))
#     else:
#         ip = ip.replace(str(i), str(ord("1"))+str(ord(str(i-10))))
# print(ip)
# ip_after = "55153507551.56.5515353506.55155194"
# ip_after = ip_after.replace('.', '')[:10]
# answer = ip_after*2
# answer = ip_after/2
# answer = answer.replace('.', '')



data = { "kk": hashlib.md5("python-requests/2.31.0".encode()).hexdigest() }
answer=""
for i in range(97,123,2):
    answer +=chr(i)
print(answer)

# this is the final staff:
answer = 'answerip/27576753775_5515350755.php'
params = {"ans":answer}

response = requests.post(URL,params=params,data=data, cookies=cookies)
print(response.text)

    


</code></pre>

<p>in the last stage, you need to run this, and the go to the URL+what the script prints</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php
$ip = 'YOUR IP';
for($i=0;$i&lt;=strlen($ip);$i++) $ip=str_replace($i,ord($i),$ip);
$ip=str_replace(".","",$ip);
$ip=substr($ip,0,10);
$answer = $ip*2;
$answer = $ip/2;
$answer = str_replace(".","",$answer);

echo "answerip/{$answer}_{$ip}.php"

?&gt;
</code></pre></div></div>

<p>(this works for me, assume we don’t have the same ip it won’t work for you)
<code class="language-plaintext highlighter-rouge">https://webhacking.kr/challenge/bonus-6/answerip/28287759875_5657551975.php</code></p>


      </section>
    </div>
  </body>
</html>
